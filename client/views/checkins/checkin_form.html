<template name="checkinForm">
	<div class="checkin">
		{{#if isFormExpanded}}
			<div class="content-padded expanded">
				{{#autoForm doc=formDocument collection="Checkins" type="insert" id="checkinForm"}}
					
					{{> afFieldInput name='text' rows=8 placeholder="What's going on?" autofocus=""}}
					{{> afFieldInput name='photo' type='hidden' value=pictureUrl}}
					
					{{#if currentGeoLocation}}
						{{#with currentGeoLocation}}
							{{> afFieldInput value=lat name='latitude' type="hidden"}}
							{{> afFieldInput value=lng name='longitude' type="hidden"}}
						{{/with}}
					{{/if}}
					{{> afFieldInput name='userId' type="hidden"}}
					
					<div class="action-container">
						{{#if pictureUrl}}
							<img src="{{pictureUrl}}" width="50">
						{{else}}
							<button class="btn camera"><i class="fa fa-camera-retro"></i></button>
						{{/if}}
						<div class="select-location">
							{{#if currentLocation}}	
						  		{{> afFieldInput name='locationName' type='hidden' value=currentLocation.name}}
								<div class="location-button">
									<a class="location-button-icon location-picker" href="#">
										{{currentLocation.name}}
									</a>
								</div>
							{{/if}}
						</div>
					</div>

					<input type="submit" class="btn-positive btn-block" value="Check in" disabled="disabled">
				{{/autoForm}}
			</div>
		{{else}}
			{{#with currentUserProfile}}
				<ul class="table-view prompt">
  					<li class="table-view-cell">
  						<div>
						   <img src="{{imageUrl}}">
					    </div>
					    <div class="username">
						   <strong>{{name}}</strong>
					    </div>
  						<button class="btn checkin-prompt fa fa-map-marker">
  						</button>
				  </li>
				</ul>
			{{/with}}
		{{/if}}
	
		{{#if isCheckinPending}}
		<strong>checking in...</strong>
		{{/if}}
	</div>

	{{>locationSelector locations=suggestedLocations}}
</template>